#!/bin/bash

if [ -x "$(command -v xcape)" ] && [ "$(hostname)" == "$LAPTOP_HOSTNAME" ]; then
  if setxkbmap -query | (! grep "ctrl:nocaps"); then
    # make capslock behave like ctrl:
    setxkbmap -option ctrl:nocaps

    # be sure to source xmodmap AFTER setxkbmap declaration
    # apparently xmodmap is partly overridden by setxkbmap
    if [ -s "$HOME/.Xmodmap" ]; then
      xmodmap "$HOME/.Xmodmap"
    fi
  fi

  pgrep xcape && pgrep xcape | xargs kill
  xcape -e 'Control_L=Escape'
  xcape -e 'Shift_L=bracketleft'
  xcape -e 'Shift_R=bracketright'
  xcape -e 'Super_L=Tab'
fi


